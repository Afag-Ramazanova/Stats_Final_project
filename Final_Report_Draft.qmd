---
title: "IDS 702 Final Report: Analysis of Police-Related Incidents: Economic and Demographic Influences"
author: "Afag, Peter, Eleanor, Mobasser"
date: "`r Sys.Date()`"
format: pdf
editor: visual
execute:
  echo: false
  warning: false
  message: false
---

```{r setup, include=FALSE}
data <- read.csv("data/police_killings.csv")
library(tidyverse)
library(knitr)
library(pander)
library(caret)
knitr::opts_chunk$set(echo = FALSE)

print(summary(data$armed))
```

## Abstract

This report investigates the relationship between economic conditions, racial composition, and the likelihood of being armed in police-related incidents. Using data from the Guardian's database on police killings linked to census data, we analyzed the role of unemployment rates, income, and poverty in shaping these outcomes. Multinomial regression revealed significant associations between economic conditions and racial composition, particularly for Black individuals in counties with lower income and higher unemployment. Logistic regression found no significant predictors of armed status, even after addressing model assumption violations. These findings highlight the influence of structural inequality on racial disparities while underscoring the need for further research on armed status predictors.

## Introduction

Police-related incidents have become a focal point of public safety research and policy discussions in recent years. The complex interplay between socioeconomic factors, racial dynamics, and law enforcement practices has sparked intense debate and calls for reform across the United States. Understanding the underlying patterns and potential contributing factors to these incidents is crucial for developing effective strategies to enhance community safety and promote equitable policing practices.

Research has shown that economic conditions and racial demographics can significantly influence crime rates and police-community interactions. Studies have found that neighborhoods with higher concentrations of low-income residents and residents of color tend to experience higher rates of police-related deaths. Additionally, unemployment and economic stress have been associated with increased rates of certain types of crime, potentially affecting police encounters. However, the relationship between economic factors and crime is complex, with some research suggesting that economic downturns may actually decrease criminal opportunities in certain contexts.

This report aims to contribute to this body of knowledge by examining two key research questions:

1.  Is there an association between the economic conditions of a county and the racial composition of individuals involved in police-related incidents?

2.  Does the likelihood of an individual being armed during such incidents vary based on their age and the unemployment rate in their area?

By analyzing data from the Guardian's database on police killings, linked with the American Community Survey (2015), this study seeks to provide insights into these critical questions (Guardian, 2015). The dataset, which includes demographic, economic, and geographic information, offers a unique opportunity to explore the potential relationships between socioeconomic factors and the characteristics of police-related incidents. Understanding these dynamics can inform evidence-based policy-making and interventions aimed at improving community safety and promoting equity in law enforcement practices.

## Methods

```{r clean-data, include=FALSE}
# Data cleaning: filter missing values and process variables
print('here')
cleaned_data <- data %>%
  mutate(
    age = as.numeric(age),
    urate = as.numeric(urate),
    gender = as.factor(gender),
    pov = as.numeric(pov),
    share_white = as.numeric(share_white),
    share_black = as.numeric(share_black),
    share_hispanic = as.numeric(share_hispanic),
    p_income = as.numeric(p_income),
    raceethnicity = ifelse(raceethnicity == "Unknown", NA,raceethnicity)
  ) %>%      
  filter(!is.na(raceethnicity) & !is.na(comp_income) & !is.na(pov) & !is.na(age) & !is.na(urate) & !is.na(armed)) %>%
  mutate(
      armed = factor(ifelse(armed %in% c("No", "Vehicle","Disputed"), "No", "Yes")),
      raceethnicity = factor(raceethnicity),  
         raceethnicity = relevel(raceethnicity, ref = "White")  
  )

# Display summary of cleaned data
glimpse(cleaned_data)
```

### Data

We used the "police_killings.csv" dataset, which includes variables such as age, racial composition, economic indicators, and whether the individual was armed. Data cleaning involved: - Filtering out missing values for relevant variables (removed `r nrow(data) - nrow(cleaned_data)` rows). - Converting "armed" into a binary factor (armed vs. unarmed) and racial categories into nominal factors. - Ensuring numeric data types for continuous variables like age, `urate`, `comp_income`, and `pov`.

**Edit**:

The dataset consists of **467 observations** and **34 columns**, providing detailed information on police-related incidents across different counties in the United States. The dataset includes variables that capture demographic information (e.g., race, gender, age), geographic details (e.g., city, state, latitude, longitude), economic indicators (e.g., household income, poverty rate, unemployment rate), and other socioeconomic factors. The primary outcome variable, `raceethnicity`, categorizes individuals involved in police-related incidents into racial groups, including "White," "Black," "Hispanic/Latino," "Asian/Pacific Islander," and "Native American." For this analysis, categories with very low representation, such as "Asian/Pacific Islander" and "Native American," were excluded to ensure model reliability.

Key economic variables include: Tract-level median household income as a share of county-level median household income (will be refered as a relative income), poverty rate at the county level, unemployment rate at the county level, the proportion of the population with a Bachelor's degree or higher. The dataset also contains demographic proportions, such as `share_white`, `share_black`, and `share_hispanic`, representing the racial composition within the county.

To prepare the data for analysis, entries with missing values were excluded. Since the number of missing values was minimal (approximately 2 or 3 for some variables), these rows were dropped without significantly affecting the overall dataset size or quality. Additionally, the outcome variable was structured to focus on three primary racial groups: "White," "Black," and "Hispanic/Latino," with "White" designated as the reference category. This decision was made due to the disproportionately low representation of individuals categorized as "Asian/Pacific Islander" and "Native American," which would have hindered the reliability of the multinomial logistic regression analysis.

### Model fitting and evaluation

For Research Question 1, which examines the relationship between economic conditions and racial composition, a multinomial logistic regression model was appropriate given the categorical nature of the outcome variable, race/ethnicity, with multiple nominal categories. The independent variables, relative income, poverty level, college level and unemployment rate, were chosen to capture key socioeconomic dimensions influencing racial or ethnic group differences. This model enables the examination of how economic factors are associated with the likelihood of belonging to different racial or ethnic categories.

For Research Question 2, a logistic regression model was employed to analyze the binary outcome variable, armed (armed status of the individual). The independent variables include age, urate (unemployment rate), gender, race/ethnicity, and college level which serve as proxies for demographic and socioeconomic factors. All interaction terms between these variables are also included to adjust for possible multicollinearity between the variable.

Both models were supported by diagnostic evaluations to ensure reliability. Correlation matrix and Variance Inflation Factor (VIF) was used to check for multicollinearity and correlation, and Cook’s distance assessed the influence of individual data points. Classification performance was further evaluated using a confusion matrix, accuracy, precision, recall, and F1 scores, providing a detailed breakdown of the model's predictive capabilities for each category. The area under the Receiver Operating Characteristic (ROC) curve (AUC) was used as an additional metric to assess the model's ability to distinguish between categories. Residual diagnostics, including residual vs. fitted plots, were used to evaluate linearity and homoscedasticity. These diagnostic evaluations and performance metrics ensure that the models are well-suited to address the research questions, effectively capturing the underlying dynamics in the data. All statistical analyses were conducted using R programming language

\[## Need to remove these as per feedback from Andrea, I couldn't figure out how to include these below in above content\]

#### Research Question 1: Economic Conditions and Racial Composition

-   **Outcome Variable**: `raceethnicity` (Nominal) – categorizes the racial/ethnic group of the deceased.
-   **Independent Variables**:
    -   `comp_income`: A measure of relative income (household income divided by county income), indicating economic status.
    -   `pov`: Poverty level in the area, providing additional context on socio-economic conditions.

A multinomial logistic regression model was fitted to examine the association:

-   `raceethnicity ~ comp_income + pov`

#### Research Question 2: Likelihood of Being Armed

-   **Outcome Variable**: `armed` (Binary) – indicates whether the deceased was armed at the time of the incident.
-   **Independent Variables**:
    -   `age`: Age of the deceased (continuous variable).
    -   `urate`: Unemployment rate in the area, representing socio-economic stress.
-   **Interaction Term**: An interaction between `age` and `urate` to assess their combined influence on the likelihood of individuals being armed.

A logistic regression model was fitted:

-   `armed ~ age + urate + age:urate`

### Model Assessment

Model diagnostics included checks for multicollinearity using Variance Inflation Factor (VIF) and assessment of influential points via Cook's distance. For the multinomial model, pseudo-R² and AIC measures were calculated. For the logistic model, residual patterns were assessed for misfit.

## Results

### Exploratory Data Analysis

```{r eda1}
par(mar = c(4, 4, 2, 2)) # Reduce margins
par(mfrow = c(2, 1))
hist(cleaned_data$age, breaks = 20, main = "Age Distribution", xlab = "Age")
hist(cleaned_data$urate, breaks = 20, main = "Unemployment Rate Distribution", xlab = "Unemployment Rate")
```

The demographic analysis shows that the deceased had a mean age in their 30s, with the age range extending to over 80. The unemployment rate in their residential tracts averaged 10%, reaching a maximum of 51%. The gender distribution was heavily skewed, with 428 males and 20 females.

```{r race-summary}
race_summary <- cleaned_data %>% count(raceethnicity) %>% mutate(Percentage = round(n / sum(n) *100,2)) 
kable(race_summary, caption = "Race Ethinicity Summary Statistics")
```

```{r eda2}
rq1_data <- cleaned_data %>% filter(raceethnicity %in% c("Black", "White", "Hispanic/Latino"))

library(reshape2)
library(ggplot2)
library(viridis)

# options(repr.plot.width = 5, repr.plot.height = 1) 
ggplot(rq1_data, aes(x = comp_income, y = raceethnicity, fill = raceethnicity)) +
  geom_boxplot(alpha = 0.7) +
  scale_fill_viridis(discrete = TRUE) +
  labs(title = "Economic Conditions and Racial Composition",
       x = "Relative Income",
       y = "Race/Ethnicity") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    legend.position = "none"
  ) +
  coord_flip()

# Create correlation matrix
cor_matrix <- cor(rq1_data[, c("comp_income", "pov", "nat_bucket", "county_bucket", "p_income", "urate")], use = "complete.obs")

# Melt the correlation matrix
cor_melted <- melt(cor_matrix)

name_mapping <- c(
  "comp_income" = "Relative Income",
  "pov" = "Poverty Rate",
  "nat_bucket" = "National Income Tier",
  "county_bucket" = "County Income Tier",
  "p_income" = "Personal Income Tier",
  "urate" = "Unemployment Rate"
)

library(scales)
# options(repr.plot.width = 5, repr.plot.height =4) 
# Create correlation plot with viridis colors
ggplot(cor_melted, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  scale_fill_viridis(option = "viridis", limits = c(-1, 1)) +
  geom_text(aes(label = round(value, 2)), 
            color = ifelse(abs(cor_melted$value) > 0.5, "white", "black"), 
            size = 4) +
  labs(title = "Correlation Plot of Economic Related Indicators",
       x = "", y = "") +
  scale_x_discrete(labels = \(x) label_wrap(10)(name_mapping[x])) +
  scale_y_discrete(labels = \(x) label_wrap(10)(name_mapping[x])) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14, face = "bold"),
    axis.text = element_text(size =7),
   # axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major = element_blank(),
    panel.border = element_blank()
  )
```

Due to sample size limitations, the racial composition analysis was restricted to three main groups: White (52%), Black, and Hispanic/Latino, with Asian and Native American groups (each \<5%) with less than 30 people being excluded from the analysis. For our **research question 1**, it is clear that a multinomial logistic regression is proficient in this case. The box plot reveals distinct income disparities across racial groups, suggesting relative income as a potentially significant predictor. Analysis of economic indicators showed high correlations among most variables, with tract-level unemployment rate being the exception. Based on this correlation analysis, we selected unemployment rate and one additional economic indicator for the final model.

### Research Question 1: Economic Conditions and Racial Composition

The results of the final multinomial logistic regression model are summarized in the table below. The predictors included in the model were chosen based on their relevance to the research question.

The findings reveal important relationships between economic conditions and racial classifications in police-related incidents. Counties with lower **relative income** (a measure of household income as a share of the county median) were more likely to see individuals involved in these incidents categorized as "Black" rather than "White." Similarly, counties with higher **unemployment rates** were associated with an increased likelihood of individuals being classified as "Black" compared to "White." These findings highlight the disproportionate impact of economic inequality and joblessness on Black individuals in the context of police-related incidents.

For "Hispanic/Latino" individuals, the relationships with economic variables were less consistent. For example, relative income showed no significant relationship with the likelihood of individuals being classified as "Hispanic/Latino" versus "White." However, counties with slightly higher **poverty rates** were marginally more likely to have individuals categorized as "Hispanic/Latino" rather than "White," though the effect was small. Counties with a higher proportion of **college-educated residents** were associated with a reduced likelihood of individuals being classified as "Hispanic/Latino" compared to "White," suggesting the potential role of education in shaping these patterns.

The confidence intervals provide a range of values within which the true effects of these factors are likely to fall, and they support the reliability of these findings. Additionally, odds ratios greater than 1 suggest an increase in likelihood, while those less than 1 suggest a decrease. For instance, the odds of being classified as Black increase significantly with higher unemployment, whereas the odds decrease with higher relative income. These conclusions are further supported by the low p-values observed for several predictors in the model, indicating that these relationships are statistically significant.

Overall, these results demonstrate how structural factors like economic inequality and unemployment disproportionately impact certain racial groups in police-related incidents. By identifying these relationships, policymakers and researchers can better understand and address the systemic factors contributing to these disparities.

```{r corr}
cols_to_numeric <- c(
                     "p_income", "h_income", "comp_income", "county_income", 
                     "urate", "college", "pov")
cor_matrix <- cor(cleaned_data[cols_to_numeric])
print(cor_matrix)
```

```{r Excluding the  2 groups}
cleaned_data <- cleaned_data[!(cleaned_data$raceethnicity %in% c("Asian/Pacific Islander", "Native American")), ]
cleaned_data$raceethnicity <- factor(cleaned_data$raceethnicity)
cleaned_data$raceethnicity <- relevel(cleaned_data$raceethnicity, ref = "White")

```

Fitting model on comp_income, poverty rate, unemployment and college, share_black

```{r rq1-model, include=FALSE}
# Multinomial logistic regression
rq1_model2 <- nnet::multinom(
  raceethnicity ~ comp_income + pov + urate + college ,
  data = cleaned_data
)

```

```{r confusion-matrix, include=FALSE}
confusionMatrix(predict(rq1_model2), cleaned_data$raceethnicity, mode="everything")

```

Accuracy of model is still: 58.29

Results:

```{r intercept 2}
intercept_tablee <- as.data.frame(cbind(
  Coefficients = summary(rq1_model2)$coefficients[, "(Intercept)"],
  Std.Errors = summary(rq1_model2)$standard.errors[, "(Intercept)"],
  p.values = 2 * (1 - pnorm(abs(summary(rq1_model2)$coefficients[, "(Intercept)"] /summary(rq1_model2)$standard.errors[, "(Intercept)"])))))
intercept_tablee$Variable <- "Intercept"
intercept_tablee
```

```{r income 2}
comp_income_tablee <- as.data.frame(cbind(
  Coefficients = summary(rq1_model2)$coefficients[, "comp_income"],
  Std.Errors = summary(rq1_model2)$standard.errors[, "comp_income"],
  p.values = 2 * (1 - pnorm(abs(summary(rq1_model2)$coefficients[, "comp_income"] /summary(rq1_model2)$standard.errors[, "comp_income"])))))
comp_income_tablee$Variable <- "Relative Income"
```

```{r poverty 2}
pov_tablee <- as.data.frame(cbind(
  Coefficients = summary(rq1_model2)$coefficients[, "pov"],
  Std.Errors = summary(rq1_model2)$standard.errors[, "pov"],
  p.values = 2 * (1 - pnorm(abs(summary(rq1_model2)$coefficients[, "pov"] /summary(rq1_model2)$standard.errors[, "pov"])))))
pov_tablee$Variable <- "Poverty Rate"

```

```{r urate 2}
urate_tablee <- as.data.frame(cbind(
  Coefficients = summary(rq1_model2)$coefficients[, "urate"],
  Std.Errors = summary(rq1_model2)$standard.errors[, "urate"],
  p.values = 2 * (1 - pnorm(abs(summary(rq1_model2)$coefficients[, "urate"] /
                                 summary(rq1_model2)$standard.errors[, "urate"])))))
urate_tablee$Variable <- "Unemployment Rate"
```

```{r urate}  urate + college + share_black}
college_tablee <- as.data.frame(cbind(
  Coefficients = summary(rq1_model2)$coefficients[, "college"],
  Std.Errors = summary(rq1_model2)$standard.errors[, "college"],
  p.values = 2 * (1 - pnorm(abs(summary(rq1_model2)$coefficients[, "college"] /summary(rq1_model2)$standard.errors[, "college"])))))
college_tablee$Variable <- "Higher Education Share"

```

```{r}
exp(confint(rq1_model2))


```

```{r}

combined_table <- rbind(intercept_tablee, comp_income_tablee, pov_tablee, urate_tablee, college_tablee #, share_black_tablee
                       )

combined_table <- combined_table %>%
  mutate(
    Odds_Ratio = exp(Coefficients),  
    CI_Lower = exp(Coefficients - 1.96 * Std.Errors),  
    CI_Upper = exp(Coefficients + 1.96 * Std.Errors)   
  )
combined_table <- cbind(`Race Ethnicity` = rownames(combined_table), combined_table)


combined_table <- combined_table[, c("Variable", "Coefficients", "Std.Errors", "Odds_Ratio", "CI_Lower", "CI_Upper", "p.values")]


combined_table <- combined_table %>%
  mutate(
    Coefficients = round(Coefficients, 2),
    Std.Errors = round(Std.Errors, 2),
    Odds_Ratio = round(Odds_Ratio, 2),
    CI_Lower = round(CI_Lower, 2),
    CI_Upper = round(CI_Upper, 2),
    p.values = round(p.values, 2)
  )

combined_table$Significance <- ifelse(
  combined_table$p.values < 0.001, "***",
  ifelse(combined_table$p.values < 0.01, "**",
         ifelse(combined_table$p.values < 0.05, "*", ""))
)

kable(combined_table, caption = "Combined Table: Coefficients, Std.Errors, Odds Ratios, Confidence Intervals, and p-values",
      col.names = c("Variable", "Coef.", "SE", "OR", "CI Low", "CI Up", "p-val", "Sig."),
      align = c('l', rep('r', 7)),  # Left align text, right align numbers
      format = "latex",
      booktabs = TRUE)

```

### Research Question 2: Likelihood of Being Armed

#### Distribution of Armed Status

To better understand the prevalence of being armed, Table 7 and the accompanying bar chart summarize the distribution of armed status. The analysis reveals that the majority of individuals in the dataset—78.09%—are armed, with only 21.91% classified as unarmed. This substantial difference underscores the predominance of armed individuals within the sample. The bar chart visually reinforces this finding, with the "Yes" category towering over the "No" category. This imbalance raises questions about the underlying reasons for such a distribution, whether cultural, legal, or related to other societal factors.

```{r armed-status-plot}
# Armed Status Distribution
armed_counts <- table(cleaned_data$armed)
armed_percentages <- prop.table(armed_counts) * 100
armed_summary <- data.frame(
  Armed_Status = names(armed_counts),
  Count = as.integer(armed_counts),
  Percentage = round(as.numeric(armed_percentages), 2) # Round percentages for clarity
)
pander(armed_summary, caption  = "Armed Status Distribution")
```

#### Relationship Between Armed Status, Age and Unemployment Rate

To take an initial look at the correlation between these three variables, we first plot a simple scatter plot between unemployment rate and age, colored by armed status.

```{r}
# Scatter plot
ggplot(cleaned_data, aes(x = age, y = urate, color = armed, shape = armed)) +
  geom_point(size = 3, alpha = 0.5) +
  labs(
    title = "Scatter Plot of Unemployment Rate vs. Age by Armed Status",
    x = "Age",
    y = "Unemployment Rate (%)",
    color = "Armed Status",
    shape = "Armed Status"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "top",
    plot.title = element_text(hjust = 0.5)
  )
```

The scatter plot shows, firstly most individuals are between 20 and 50 years old, with unemployment rates clustering below 20%. The "Yes" (armed) group is more evenly distributed across ages and slightly concentrated at lower unemployment rates, while the "No" (unarmed) group shows a few more cases of elevated unemployment rates above 20%. Outliers with unemployment rates exceeding 40% appear primarily in the armed group. Overall, no clear trend emerges between age and unemployment rate, and the patterns between armed and unarmed groups are broadly similar.

We further explore the relationship between age and armed status through a box plot, which compares the age distribution for armed and unarmed individuals. The plot illustrates that the age ranges and medians for both groups are remarkably similar, suggesting no significant difference in age distribution between those who are armed and those who are not. This visual evidence supports the regression findings, reinforcing the conclusion that age alone is not a strong determinant of armed status. Nonetheless, the lack of significant variability in the data suggests that other contextual factors beyond age may play a more crucial role in influencing armed status.

```{r armed-age-plot}
# Plot 2: Relationship between 'armed' and 'age'
plot4 <- ggplot(cleaned_data, aes(x = armed, y = age)) +
  geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.shape = 1) +
  geom_jitter(width = 0.2, alpha = 0.2) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Relationship between Armed Status and Age",
       x = "Armed Status",
       y = "Age")
plot4

```

```{r}
# Plot 2: Relationship between 'armed' and 'age'
plot5 <- ggplot(cleaned_data, aes(x = armed, y = urate)) +
  geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.shape = 1) +
  geom_jitter(width = 0.2, alpha = 0.2) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Relationship between Armed Status and Unemplyement Rate",
       x = "Armed Status",
       y = "Unemployment Rate")
plot5


```

In a similar manner, we can take a deeper dive into the relationship between armed status and unemployment rate by plotting a box plot with jittered points for both groups. The visualization demonstrates that the median and interquartile range of unemployment rates are relatively similar for armed and unarmed individuals. However, the presence of outliers, particularly for the armed group, suggests that there may be certain individuals with unusually high unemployment rates. Despite this, the overall spread of the data indicates that unemployment rate, much like age, does not exhibit strong variability across armed status groups. This lack of pronounced difference implies that other contextual factors beyond unemployment rate likely play a more significant role in influencing armed status.

#### Logistic Regression

**Motivation and Model Design**

While the earlier exploratory data analysis (EDA) did not reveal pronounced relationships between **age**, **unemployment rate (urate)**, and **armed status**, a logistic regression model was employed to formally quantify these relationships and test for statistical significance. To account for potential confounding effects, **college education status** and **poverty levels (pov)** were included in the model. These variables are theoretically relevant, as they may influence socioeconomic conditions that impact both unemployment rates and armed status.

The **college** variable represents whether individuals have attained higher education. Lower education levels are often associated with higher unemployment rates, which can indirectly contribute to social or economic stress factors that correlate with armed status. Similarly, **poverty (pov)** measures the proportion of individuals in poverty within a region. Poverty may directly or indirectly influence armed status through economic insecurity, limited access to resources, or broader community-level factors. By including these variables, the model adjusts for their potential confounding effects and ensures that any observed relationships between age, unemployment rate, and armed status are not falsely attributed due to omitted variable bias.

```{r rq2-model}
# Logistic regression
library(car)
rq2_model <- glm(
  armed ~ (age + urate +  college + pov)^2,  data = cleaned_data,
  family = binomial
)

# Display the summary of the updated model
pander(summary(rq2_model))

# Check for multicollinearity using Variance Inflation Factor (VIF)
vif_values <- vif(rq2_model)
print(vif_values)

# Diagnostic plots
par(mfrow = c(2, 2)) # Set plotting area to 2x2

# Residual vs Fitted
plot(rq2_model$fitted.values, residuals(rq2_model, type = "deviance"),
     xlab = "Fitted Values",
     ylab = "Deviance Residuals",
     main = "Residuals vs Fitted",
     pch = 20, col = "blue")
abline(h = 0, col = "red", lty = 2)

# Normal Q-Q Plot
qqnorm(residuals(rq2_model, type = "deviance"), 
       main = "Normal Q-Q Plot of Residuals",
       pch = 20, col = "blue")
qqline(residuals(rq2_model, type = "deviance"), col = "red", lty = 2)

# Scale-Location Plot
plot(rq2_model$fitted.values, sqrt(abs(residuals(rq2_model, type = "deviance"))),
     xlab = "Fitted Values",
     ylab = "Sqrt |Deviance Residuals|",
     main = "Scale-Location Plot",
     pch = 20, col = "blue")
abline(h = 0, col = "red", lty = 2)

# Cook's Distance
plot(cooks.distance(rq2_model), 
     xlab = "Index",
     ylab = "Cook's Distance",
     main = "Cook's Distance",
     pch = 20, col = "blue")
abline(h = 4/(nrow(cleaned_data) - length(rq2_model$coefficients)), col = "red", lty = 2)

par(mfrow = c(1, 1)) # Reset plotting area

# Confusion Matrix for Model Evaluation
rq2_model_pred <- ifelse(predict(rq2_model, type = "response") > 0.5, 1, 0)
rq2_model_pred_fac <- factor(rq2_model_pred, levels = c(0, 1), labels = c("No", "Yes"))

conf_matrix <- confusionMatrix(
  table(rq2_model_pred_fac, cleaned_data$armed),
  positive = "Yes",
  mode = "everything"
)
pander(conf_matrix)
```

### Key Results

The regression results are summarized below:

::: {.cell tbl-cap="Regression Results"}
| **Variable**                | **Estimate** | **Std. Error** | **z-value** | **p-value** |
|:---------------|-------------:|-------------:|-------------:|-------------:|
| **Intercept**               |        0.512 |          1.413 |      0.3622 |      0.7172 |
| **Age of Individuals**      |      -0.0046 |         0.0284 |     -0.1629 |      0.8706 |
| **Unemployment Rate**       |        13.33 |           8.64 |       1.543 |      0.1227 |
| **College Completion**      |        1.166 |          3.198 |      0.3645 |      0.7155 |
| **Poverty Rate**            |       0.0191 |         0.0421 |      0.4531 |      0.6505 |
| **Age × Unemployment Rate** |      -0.1457 |         0.1549 |     -0.9409 |      0.3468 |
| **Unemployment × College**  |       -30.59 |          17.32 |      -1.766 |      0.0774 |
:::

### Interpretation of Results

The results show that **age** does not significantly predict armed status (p = 0.8706), consistent with earlier findings where age distributions were similar across groups. While the **unemployment rate (urate)** has a positive relationship with armed status (Estimate = 13.33), it is not statistically significant (p = 0.1227), suggesting a possible but inconclusive link.

Both **college education** and **poverty levels (pov)** have weak individual effects (p \> 0.65), but their inclusion helps account for confounding factors. Interestingly, the interaction term **Urate × College** is close to significance (p = 0.0774), hinting that unemployment may have a stronger impact on individuals with lower education levels.

Overall, interactions like **Age × Urate** and **Urate × College** suggest that age, education, and poverty interact in complex ways, shaping how unemployment relates to armed status.

### Model Diagnostics

The diagnostic plots reveal several issues with the current model fit. In the **Residuals vs. Fitted plot**, the residuals display a non-random pattern, suggesting violations of the assumptions of independence and homoscedasticity, indicating that the model may not fully capture the data's underlying structure. The **Normal Q-Q plot** shows deviations from the diagonal line, particularly at the tails, pointing to non-normally distributed residuals. While normality is less critical for logistic regression, extreme deviations can still affect the model's performance. Additionally, the **Scale-Location plot** highlights an uneven spread of residuals, reinforcing the presence of heteroscedasticity. Finally, **Cook's Distance** highlights influential points that may skew the model's results, making it necessary to address them for improved reliability.

```{r}
# Cook's Distance threshold
cooks_threshold <- 4 / nrow(cleaned_data)
cooks_values <- cooks.distance(rq2_model)

# Identify influential observations
influential_points <- which(cooks_values > cooks_threshold)

# Remove influential observations
cleaned_data_refit <- cleaned_data[-influential_points, ]

# Refit the logistic regression model
rq2_model_refit <- glm(
  armed ~ (age + urate + college + pov)^2, 
  data = cleaned_data_refit,
  family = binomial
)

# Summary of refitted model
pander(summary(rq2_model_refit))

# Re-check model assumptions with diagnostic plots
par(mfrow = c(2, 2))
plot(rq2_model_refit)
par(mfrow = c(1, 1))

# Check for significance
if (any(summary(rq2_model_refit)$coefficients[, 4] < 0.05)) {
  print("Significant relationships were found after removing outliers.")
} else {
  print("Results remain insignificant; no significant relationships observed.")
}


# Calculate Cook's Distance for refitted model
cooks_values_refit <- cooks.distance(rq2_model_refit)

# Plot Cook's Distance
plot(
  cooks_values_refit, 
  pch = 20, 
  cex = 1, 
  col = "blue",
  main = "Cook's Distance After Removing Outliers",
  ylab = "Cook's Distance",
  xlab = "Observation Index"
)
abline(h = cooks_threshold, col = "red", lty = 2) # Threshold line
text(
  x = which(cooks_values_refit > cooks_threshold), 
  y = cooks_values_refit[cooks_values_refit > cooks_threshold], 
  labels = which(cooks_values_refit > cooks_threshold), 
  pos = 3, 
  cex = 0.7, 
  col = "red"
)


```

The initial diagnostic plots showed some issues with our model, like non-random residual patterns and influential points flagged by Cook's Distance. To fix this, we removed observations with Cook's Distance values above the threshold ($( 4/n )$) and refitted the logistic regression model using the cleaned data.

After refitting, the results still didn’t show any significant predictors. **Age** (p = 0.9417), **unemployment rate (urate)** (p = 0.3164), **college education** (p = 0.4203), and **poverty (pov)** (p = 0.2609) all remained insignificant. Even the interaction terms, like **age:urate** and **urate:college**, didn’t produce meaningful effects. Although the residual deviance improved slightly (416.8 on 396 degrees of freedom), the overall model performance didn’t change much.

In summary, removing outliers didn’t uncover any strong relationships between these predictors and armed status. It seems these variables, on their own or combined, don’t explain much in this dataset. Exploring other variables or alternative modeling approaches might give us better insights.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ \[TODO: Comment on the model fit etc., talk about the model assumptions, and try refitting the model after excluding outliers based on cook's distance Logic: 1. We see that the variables are not significant -\> comment on that 2. However, we also see that several model assumptions might have been violated based on the diagnostic plot 3. Refit the model 4. -\> if results are significant, write an interpretation saying that we found significant correlation -\> else: write how the results are still not significant, and there's no significant correlation between the variables etc.\]

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

### Conclusion (only includes research Q2 conclusion, content may need to be edited to reduce word limit after adding Research Q1 conclusion)

The key takeaway from this analysis is that **age**, **unemployment rate (urate)**, **college education status**, and **poverty levels (pov)** do not significantly predict the likelihood of being armed in this dataset. Despite exploring interaction effects and accounting for potential confounding factors, the logistic regression model yielded no statistically significant results. While the **unemployment rate** showed a positive but inconclusive effect and the **Urate × College** interaction approached significance, these relationships remain weak and require further investigation.

This study is not without limitations. The dataset may lack key explanatory variables that capture the broader socioeconomic or contextual factors influencing armed status. Additionally, the relatively small sample size and presence of influential observations may have limited the model's ability to detect subtle relationships.

Future work in this area can focus on incorporating additional predictors, such as crime rates, regional policies, or mental health indicators, which may provide a more comprehensive understanding of the factors influencing armed status. Expanding the dataset and exploring advanced modeling techniques, such as mixed-effects models or machine learning approaches, could further enhance predictive power and uncover nuanced relationships. By addressing these limitations, future research can build a more complete picture of the social and economic drivers behind armed status.
